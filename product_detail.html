<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Details - Classic Decor</title>
    <meta
      name="description"
      content="View details of our exquisite dress collection at Aiza Clothing Brand. High-quality fabric, unique design, and perfect fit for every woman."
    />
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <header class="header">
      <div class="logo">
        <a href="index.html" class="logo-text">Classic Decor</a>
      </div>
      <nav>
        <ul></ul>
      </nav>
      <div class="header-actions">
        <a href="shop.html" class="icon-btn" title="Shop"
          ><i class="fa-solid fa-store"></i
        ></a>
        <a href="#" id="search-toggle" class="icon-btn" title="Search"
          ><i class="fa-solid fa-magnifying-glass"></i
        ></a>
        <a href="login.html" class="icon-btn" title="Account"
          ><i class="fa-regular fa-user"></i
        ></a>
        <a href="cart.html" class="icon-btn" title="Cart"
          ><i class="fa-solid fa-cart-shopping"></i
          ><span id="nav-cart-count">0</span></a
        >
      </div>
    </header>
    <div id="search-overlay" class="search-overlay" aria-hidden="true">
      <div class="search-panel">
        <button
          id="search-close"
          class="search-close"
          aria-label="Close search"
        >
          &times;
        </button>
        <form id="search-form" class="search-form" role="search">
          <input
            id="search-input"
            type="search"
            name="q"
            placeholder="Search products, categories..."
            aria-label="Search"
            autocomplete="off"
          />
          <button type="submit" class="search-submit">Search</button>
        </form>
      </div>
    </div>
    <nav class="category-nav">
      <div class="category-container">
        <ul>
          <li><a href="categories.html?category=wall-art">Wall Art</a></li>
          <li>
            <a href="categories.html?category=wall-mirrors">Wall Mirrors</a>
          </li>
          <li>
            <a href="categories.html?category=wall-clocks">Wall Clocks</a>
          </li>
          <li>
            <a href="categories.html?category=name-plates">Name Plates</a>
          </li>
          <li>
            <a href="categories.html?category=photo-frames">Photo Frames</a>
          </li>
          <li><a href="categories.html?category=kids-decor">Kids Decor</a></li>
          <li><a href="categories.html?category=shelves">Shelves</a></li>
          <li><a href="categories.html?category=vases">Flower Vases</a></li>
        </ul>
      </div>
    </nav>

    <main>
      <section class="product-detail">
        <div class="product-image-gallery">
          <img
            src="images/our_products.jpg"
            alt="Elegant A-Line Dress - Product Image"
            class="main-image"
            title="Elegant A-Line Dress"
            onerror="this.onerror=null;this.src='images/our_products.jpg'"
          />
          <!-- <img src="images/product_1_thumbnail.jpg" alt="Product 1 Thumbnail" class="thumbnail-image"> -->
        </div>
        <div class="product-info">
          <h2 class="product-name">Elegant A-Line Dress</h2>
          <p class="product-description">
            This elegant A-Line dress is perfect for any occasion. Made with
            high-quality fabric, it offers a comfortable fit and a sophisticated
            look. Available in various sizes and colors.
          </p>
          <p class="product-price">PKR 49.99</p>

          <div class="product-options">
            <div class="option-group" id="size-group" style="display: none">
              <label for="size">Size:</label>
              <select id="size"></select>
            </div>
            <div class="option-group" id="color-group" style="display: none">
              <label for="color">Color:</label>
              <select id="color"></select>
            </div>
          </div>

          <button class="add-to-cart-detail">Add to Cart</button>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-container">
        <div class="footer-column">
          <h3 class="logo-text">Classic Decor</h3>
          <p>
            Your trusted destination for premium acrylic home d√©cor. Explore
            modern wall art, elegant mirrors, clocks, and customized designs
            crafted to elevate your living space with style.
          </p>
        </div>
        <div class="footer-column">
          <h3>Customer Service</h3>
          <ul>
            <li><a href="#">Contact Us</a></li>
            <li><a href="#">Shipping & Returns</a></li>
            <li><a href="#">FAQ</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Legal</h3>
          <ul>
            <li><a href="#">Terms of Service</a></li>
            <li><a href="#">Privacy Policy</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Stay Connected</h3>
          <div class="social-media">
            <a href="#"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"
                ></path></svg
            ></a>
            <a href="#"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                <path
                  d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"
                ></path>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg
            ></a>
            <a href="#"
              ><svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"
                ></path></svg
            ></a>
          </div>
          <div class="newsletter">
            <p>Sign up for our newsletter to get the latest updates.</p>
            <form>
              <input type="email" placeholder="Enter your email" />
              <button type="submit">Subscribe</button>
            </form>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Classic Decor. All Rights Reserved.</p>
      </div>
    </footer>

    <script src="cart.js"></script>
    <script src="script.js"></script>
    <script>
      async function renderProductDetail() {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get("id");

        // If loadServerProducts is available (script.js), wait for it so window.products is populated
        try {
          if (typeof loadServerProducts === "function")
            await loadServerProducts();
        } catch (_) {}

        // Access the global products array from script.js (server-loaded or fallback)
        const list =
          window.products || window.products === null
            ? window.products
            : typeof products !== "undefined"
            ? products
            : [];
        const product = Array.isArray(list)
          ? list.find((p) => String(p.id) === String(productId))
          : null;
        try {
          console.debug("[ProductDetail] load", {
            productId,
            found: !!product,
          });
        } catch (e) {}

        if (product) {
          const imgEl = document.querySelector(".product-image-gallery img");
          if (imgEl) {
            imgEl.onerror = function () {
              this.onerror = null;
              this.src = "images/our_products.jpg";
            };
            imgEl.src = product.image;
            imgEl.alt = product.name + " - Product Image";
            imgEl.title = product.name;
          }
          const nameEl = document.querySelector(".product-name");
          if (nameEl) nameEl.textContent = product.name;
          const descEl = document.querySelector(".product-description");
          if (descEl)
            descEl.textContent =
              product.description || product.metaDescription || "";
          const priceEl = document.querySelector(".product-price");
          if (priceEl)
            priceEl.textContent = `PKR ${Number(product.price || 0).toFixed(
              0
            )}`;

          // Populate variant selects if product has variants
          const sizeGroup = document.getElementById("size-group");
          const colorGroup = document.getElementById("color-group");
          const sizeSel = document.getElementById("size");
          const colorSel = document.getElementById("color");
          if (
            product.variants &&
            Array.isArray(product.variants.sizes) &&
            product.variants.sizes.length
          ) {
            sizeSel.innerHTML = product.variants.sizes
              .map((s) => `<option value="${s}">${s}</option>`)
              .join("");
            sizeGroup.style.display = "";
          } else {
            sizeGroup.style.display = "none";
          }
          if (
            product.variants &&
            Array.isArray(product.variants.colors) &&
            product.variants.colors.length
          ) {
            colorSel.innerHTML = product.variants.colors
              .map((c) => `<option value="${c}">${c}</option>`)
              .join("");
            colorGroup.style.display = "";
          } else {
            colorGroup.style.display = "none";
          }

          // Ensure add-to-cart-detail button has product id data attribute
          const addBtn = document.querySelector(".add-to-cart-detail");
          if (addBtn) addBtn.dataset.productId = product.id;
        } else {
          // Handle product not found
          const container = document.querySelector(".product-detail");
          if (container)
            container.innerHTML =
              "<h2>Product Not Found</h2><p>The product you are looking for does not exist.</p>";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        renderProductDetail();
      });
    </script>
  </body>
</html>
